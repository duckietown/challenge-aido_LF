challenge: aido5-LFV_multi-sim-testing

title: "LFV_multi ðŸš—ðŸš—ðŸš— - Lane following multibody (simulation ðŸ‘¾, testing ðŸ¥‡))"
tags: [visible, ml-testing, aido5, aido5-embodied, LFV, v4, simulation]
description: |


  In this variation of the lane following challenge,
  your agent is *embodied in multiple robots*.
  Avoid the crashes with different versions of yourself.

  See the [documentation] for more details.

  [documentation]: https://docs.duckietown.org/daffy/AIDO/out/lf_vm.html


protocol: aido2_db18_agent-z2

date-open: 2020-09-15T00:00Z
date-close: 2020-12-05T00:00Z

scoring: !include scoring.yaml

steps:
  LFVmultibodyv-sim:
    title: Simulation step
    description: ""
    features_required:
      compute_sims: 1 # computation machine

    timeout: 3600 # 1 hour
    evaluation_parameters:
      services:
        evaluator:
          environment:
            experiment_manager_parameters: |
              episodes_per_scenario: 3
              episode_length_s: 60.0
              min_episode_length_s: 0.0
              seed: 20200922
              physics_dt: 0.05
              max_failures: 2
              fifo_dir: /fifos
              sim_in: /fifos/simulator-in
              sim_out: /fifos/simulator-out
              sm_in: /fifos/scenario_maker-in
              sm_out: /fifos/scenario_maker-out
              timeout_initialization: 120
              timeout_regular: 120


              port: 10123 # visualization port

          image: ${AIDO_REGISTRY}/duckietown/challenge-aido_lf-experiment_manager:daffy-amd64
          ports:
            - 10123

        simulator:
          image: ${AIDO_REGISTRY}/duckietown/challenge-aido_lf-simulator-gym:daffy-amd64

          environment:
            AIDONODE_DATA_IN: /fifos/simulator-in
            AIDONODE_DATA_OUT: fifo:/fifos/simulator-out
            AIDONODE_CONFIG: |
              env_constructor: Simulator
              env_parameters:
                max_steps: 500001 # we don't want the gym to reset itself
                domain_rand: 0
                camera_width: 640
                camera_height: 480
                distortion: true
                num_tris_distractors: 0
                color_ground: [0, 0.3, 0] # green
                enable_leds: true
              topdown_resolution: 600
              debug_no_video: false

        solution-ego0:
          image: SUBMISSION_CONTAINER
          environment:
            AIDONODE_NAME: ego0
            AIDONODE_DATA_IN: /fifos/ego0-in
            AIDONODE_DATA_OUT: fifo:/fifos/ego0-out

        solution-ego1:
          image: SUBMISSION_CONTAINER
          environment:
            AIDONODE_NAME: ego1
            AIDONODE_DATA_IN: /fifos/ego1-in
            AIDONODE_DATA_OUT: fifo:/fifos/ego1-out
        solution-ego2:
          image: SUBMISSION_CONTAINER
          environment:
            AIDONODE_NAME: ego2
            AIDONODE_DATA_IN: /fifos/ego2-in
            AIDONODE_DATA_OUT: fifo:/fifos/ego2-out


        scenario_maker:
          environment:
            AIDONODE_DATA_IN: /fifos/scenario_maker-in
            AIDONODE_DATA_OUT: fifo:/fifos/scenario_maker-out
            AIDONODE_CONFIG: |
              maps:
                - ETHZ_autolab_technical_track
              scenarios_per_map: 1
              robots_npcs: [ ]
              robots_pcs: [ego0, ego1, ego2]
              robots_parked: [parked0, parked1]
              # robots_parked: [parked0, parked1, parked2, parked3, parked4, parked5]
          image: ${AIDO_REGISTRY}/duckietown/challenge-aido_lf-scenario_maker:daffy-amd64


dependencies:
#  aido5-LF-sanity-sim-validation: !include dep-sanity.yaml
  aido5-LFV_multi-sim-validation:
    description: The submission must first pass the validation step.
    min_threshold: 2.0
    scores:
      good_enough:
        description: Must have moved at least 20cm.
        importance: 1.0
        score_name: driven_lanedir_consec_median
        score_min: 0.2
        score_max: 10000.0
    comparisons:
      better-than-bea-straight:
        description: Must be do better than the straight solution.
        importance: 1.0
        username: "1639"
        sub_label: 'straight'
